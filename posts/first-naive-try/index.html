<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A first naive model.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>First Naive Try | Notes on Kaggle</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Kaggle-Competitions/posts/first-naive-try/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="Cloistered Monkey">
<link rel="prev" href="../exploring-the-data/" title="Exploring The Data" type="text/html">
<link rel="next" href="../feature-extraction-from-text-and-images/" title="Feature Extraction From Text and Images" type="text/html">
<meta property="og:site_name" content="Notes on Kaggle">
<meta property="og:title" content="First Naive Try">
<meta property="og:url" content="https://necromuralist.github.io/Kaggle-Competitions/posts/first-naive-try/">
<meta property="og:description" content="A first naive model.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-08-11T19:37:37-07:00">
<meta property="article:tag" content="naive model">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://necromuralist.github.io/Kaggle-Competitions/">

                <span id="blog-title">Notes on Kaggle</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="https://necromuralist.github.io/">The Cloistered Monkey</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="https://necromuralist.github.io/Kaggle-Competitions/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.org" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">First Naive Try</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Cloistered Monkey
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-08-11T19:37:37-07:00" itemprop="datePublished" title="2018-08-11 19:37">2018-08-11 19:37</time></a></p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org60874bf">Introduction</a></li>
<li><a href="#org8157e78">Imports</a></li>
<li><a href="#orge860bff">Loading the Data</a></li>
<li><a href="#orga4040b2">The Linear Model</a></li>
</ul>
</div>
</div>
<div id="outline-container-org60874bf" class="outline-2">
<h2 id="org60874bf">Introduction</h2>
<div class="outline-text-2" id="text-org60874bf">
<p>
This is going to be a naive attempt to get this project running. If you look at the <a href="http://scikit-learn.org/stable/tutorial/machine_learning_map/index.html">sklearn flowchart</a> and follow the path through regression with more than 100,000 samples (we have 1,287,299 entries in the training set (after splitting out the validation set from it)) you end up with two cases:
</p>

<ul class="org-ul">
<li>a few important features
<ul class="org-ul">
<li>lasso</li>
<li>electric net</li>
</ul>
</li>
<li>Many important Features
<ul class="org-ul">
<li>ridge regression</li>
<li>svr</li>
<li>ensemble regressors</li>
</ul>
</li>
</ul>
<p>
I kind of think there won't be too many important features, although I might be wrong. This chart might not be up-to-date, since it says that the ensemble regressors don't work, but I'm pretty sure Random Forest Regression is implemented. In any case, I'm going to see what each of the models does if I just use the defaults in order to get a baseline.
</p>
</div>
</div>
<div id="outline-container-org8157e78" class="outline-2">
<h2 id="org8157e78">Imports</h2>
<div class="outline-text-2" id="text-org8157e78">
<div class="highlight"><pre><span></span># python standard library
import warnings
import os
import pickle

warnings.filterwarnings("ignore", message="numpy.dtype size changed")
warnings.filterwarnings("ignore", message="numpy.ufunc size changed")

# from pypi
import numpy
import pandas
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import cross_val_score
from sklearn.ensemble import RandomTreesRegressor
from tabulate import tabulate

# this project
from helpers.helpers import (
    Helpers,
    DataSource,
    DataKeys,
    Pickles,
    )
</pre></div>
</div>
</div>
<div id="outline-container-orge860bff" class="outline-2">
<h2 id="orge860bff">Loading the Data</h2>
<div class="outline-text-2" id="text-orge860bff">
<div class="highlight"><pre><span></span>DataSource = Helpers.unpickle("DataSource")
</pre></div>

<p>
This probably doesn't make sense anymore. Better to just get the random seed and use <code>train_test_split</code>, maybe.
</p>
<div class="highlight"><pre><span></span>x_train = Helpers.unpickle(Pickles.x_train)
x_test = Helpers.unpickle(Pickles.x_test)
y_train = Helpers.unpickle(Pickles.y_train)
y_test = Helpers.unpickle(Pickles.y_test)
</pre></div>

<div class="highlight"><pre><span></span>Helpers.print_head(x_train)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_category_id</th>
<th scope="col" class="org-right">month</th>
<th scope="col" class="org-right">year</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">11</td>
<td class="org-right">15</td>
<td class="org-right">1324</td>
<td class="org-right">499</td>
<td class="org-left">ARMSTRONG LOUIS  Essential Collection  3CD</td>
<td class="org-right">55</td>
<td class="org-right">12</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">18</td>
<td class="org-right">31</td>
<td class="org-right">19981</td>
<td class="org-right">499</td>
<td class="org-left">Толстой Л.Н.  Война и мир  Роман-эпопея  4CD (mp3-CD) (Jewel)</td>
<td class="org-right">43</td>
<td class="org-right">07</td>
<td class="org-right">2014</td>
</tr>
<tr>
<td class="org-right">32</td>
<td class="org-right">28</td>
<td class="org-right">7934</td>
<td class="org-right">398</td>
<td class="org-left">XOne: Пульт дистанционного управления для Xbox One [6DV-00006]</td>
<td class="org-right">7</td>
<td class="org-right">09</td>
<td class="org-right">2015</td>
</tr>
<tr>
<td class="org-right">12</td>
<td class="org-right">43</td>
<td class="org-right">13518</td>
<td class="org-right">1499</td>
<td class="org-left">Комплект Прогулки с динозаврами (только для PS Move) [PS3, русская версия] + Wonderbook</td>
<td class="org-right">19</td>
<td class="org-right">01</td>
<td class="org-right">2014</td>
</tr>
<tr>
<td class="org-right">28</td>
<td class="org-right">25</td>
<td class="org-right">19927</td>
<td class="org-right">329</td>
<td class="org-left">Таривердиев М. Инструментальные кинохиты (подар. уп.) (mp3-CD) (Jewel)</td>
<td class="org-right">57</td>
<td class="org-right">05</td>
<td class="org-right">2015</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orga4040b2" class="outline-2">
<h2 id="orga4040b2">The Linear Model</h2>
<div class="outline-text-2" id="text-orga4040b2">
<p>
What happens if we just use the default linear regression model? The first problem we have is that we have both non-numeric data and categorical data. I think removing the <code>item_name</code> variable seems reasonable at this point, since we have unique <code>item_id</code> values for each item, although it's possible that some text-mining might reveal something in the names, because this is just a naive approach that will use linear regression.
</p>

<div class="highlight"><pre><span></span>del(x_train[DataKeys.name])
</pre></div>

<div class="highlight"><pre><span></span>regression = linear_model.LinearRegression()
regression.fit(x_train, y_train)
</pre></div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/naive-model/" rel="tag">naive model</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../exploring-the-data/" rel="prev" title="Exploring The Data">Previous post</a>
            </li>
            <li class="next">
                <a href="../feature-extraction-from-text-and-images/" rel="next" title="Feature Extraction From Text and Images">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
