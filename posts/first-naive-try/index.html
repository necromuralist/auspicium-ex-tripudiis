<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A first naive model.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>First Naive Try | Notes on Kaggle</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Kaggle-Competitions/posts/first-naive-try/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="Cloistered Monkey">
<link rel="prev" href="../exploring-the-data/" title="Exploring The Data" type="text/html">
<link rel="next" href="../feature-extraction-from-text-and-images/" title="Feature Extraction From Text and Images" type="text/html">
<meta property="og:site_name" content="Notes on Kaggle">
<meta property="og:title" content="First Naive Try">
<meta property="og:url" content="https://necromuralist.github.io/Kaggle-Competitions/posts/first-naive-try/">
<meta property="og:description" content="A first naive model.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-08-11T19:37:37-07:00">
<meta property="article:tag" content="naive model competition">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://necromuralist.github.io/Kaggle-Competitions/">

                <span id="blog-title">Notes on Kaggle</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="https://necromuralist.github.io/">The Cloistered Monkey</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="https://necromuralist.github.io/Kaggle-Competitions/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.org" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">First Naive Try</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Cloistered Monkey
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-08-11T19:37:37-07:00" itemprop="datePublished" title="2018-08-11 19:37">2018-08-11 19:37</time></a></p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge49dd6f">Introduction</a></li>
<li><a href="#org8432a62">Imports</a></li>
<li><a href="#orgea2131d">Loading the Data</a></li>
<li><a href="#orgaeb618d">November Only</a></li>
<li><a href="#org7bd8d62">The Linear Model</a></li>
</ul>
</div>
</div>
<div id="outline-container-orge49dd6f" class="outline-2">
<h2 id="orge49dd6f">Introduction</h2>
<div class="outline-text-2" id="text-orge49dd6f">
<p>
Our goal is to predict the number of sales for each shop for November 2015 (based on the prior months). I'm going to make some very naive guesses here with some models that only use the prior dates and the target counts.
</p>
</div>
</div>
<div id="outline-container-org8432a62" class="outline-2">
<h2 id="org8432a62">Imports</h2>
<div class="outline-text-2" id="text-org8432a62">
</div>
<div id="outline-container-orgd603886" class="outline-3">
<h3 id="orgd603886">Python Standard Library</h3>
<div class="outline-text-3" id="text-orgd603886">
<div class="highlight"><pre><span></span># python standard library
import warnings
import os
import pickle
</pre></div>
</div>
</div>

<div id="outline-container-org198a91a" class="outline-3">
<h3 id="org198a91a">Supress the Warnings</h3>
<div class="outline-text-3" id="text-org198a91a">
<div class="highlight"><pre><span></span>warnings.filterwarnings("ignore", message="numpy.dtype size changed")
warnings.filterwarnings("ignore", message="numpy.ufunc size changed")
</pre></div>
</div>
</div>

<div id="outline-container-orgbfe12c0" class="outline-3">
<h3 id="orgbfe12c0">From pypi</h3>
<div class="outline-text-3" id="text-orgbfe12c0">
<div class="highlight"><pre><span></span>import numpy
import pandas
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import cross_val_score
from sklearn.ensemble import RandomTreesRegressor
from tabulate import tabulate
</pre></div>
</div>
</div>

<div id="outline-container-org589fa67" class="outline-3">
<h3 id="org589fa67">This Project</h3>
<div class="outline-text-3" id="text-org589fa67">
<div class="highlight"><pre><span></span># this project
from helpers.helpers import (
    Helpers,
    DataSource,
    DataKeys,
    Pickles,
    )
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgea2131d" class="outline-2">
<h2 id="orgea2131d">Loading the Data</h2>
<div class="outline-text-2" id="text-orgea2131d">
<div class="highlight"><pre><span></span>x_train = Helpers.unpickle(Pickles.x_train)
x_test = Helpers.unpickle(Pickles.x_test)
y_train = Helpers.unpickle(Pickles.y_train)
y_test = Helpers.unpickle(Pickles.y_test)
</pre></div>

<p>
To make it easier to filter I'm going to combine the x and y data.
</p>

<div class="highlight"><pre><span></span>DataKeys.target = "Month Count"
x_train[DataKeys.target] = y_train.values
x_test[DataKeys.target] = y_test.values
</pre></div>

<div class="highlight"><pre><span></span>Helpers.print_head(x_train)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_category_id</th>
<th scope="col" class="org-right">month</th>
<th scope="col" class="org-right">year</th>
<th scope="col" class="org-right">Month Count</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">11</td>
<td class="org-right">15</td>
<td class="org-right">1324</td>
<td class="org-right">499</td>
<td class="org-right">55</td>
<td class="org-right">12</td>
<td class="org-right">2013</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">18</td>
<td class="org-right">31</td>
<td class="org-right">19981</td>
<td class="org-right">499</td>
<td class="org-right">43</td>
<td class="org-right">07</td>
<td class="org-right">2014</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-right">32</td>
<td class="org-right">28</td>
<td class="org-right">7934</td>
<td class="org-right">398</td>
<td class="org-right">7</td>
<td class="org-right">09</td>
<td class="org-right">2015</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">12</td>
<td class="org-right">43</td>
<td class="org-right">13518</td>
<td class="org-right">1499</td>
<td class="org-right">19</td>
<td class="org-right">01</td>
<td class="org-right">2014</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">28</td>
<td class="org-right">25</td>
<td class="org-right">19927</td>
<td class="org-right">329</td>
<td class="org-right">57</td>
<td class="org-right">05</td>
<td class="org-right">2015</td>
<td class="org-right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgaeb618d" class="outline-2">
<h2 id="orgaeb618d">November Only</h2>
<div class="outline-text-2" id="text-orgaeb618d">
<p>
What happens if we only use the month of November in the data?
</p>

<div class="highlight"><pre><span></span>training = x_train[x_train.month == "11"]
</pre></div>

<div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div id="outline-container-org7bd8d62" class="outline-2">
<h2 id="org7bd8d62">The Linear Model</h2>
<div class="outline-text-2" id="text-org7bd8d62">
<p>
What happens if we just use the default linear regression model? The first problem we have is that we have both non-numeric data and categorical data. I think removing the <code>item_name</code> variable seems reasonable at this point, since we have unique <code>item_id</code> values for each item, although it's possible that some text-mining might reveal something in the names, because this is just a naive approach that will use linear regression.
</p>

<div class="highlight"><pre><span></span>del(x_train[DataKeys.name])
</pre></div>

<div class="highlight"><pre><span></span>regression = linear_model.LinearRegression()
regression.fit(x_train, y_train)
</pre></div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/naive-model-competition/" rel="tag">naive model competition</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../exploring-the-data/" rel="prev" title="Exploring The Data">Previous post</a>
            </li>
            <li class="next">
                <a href="../feature-extraction-from-text-and-images/" rel="next" title="Feature Extraction From Text and Images">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
