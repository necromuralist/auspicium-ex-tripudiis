<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Looking at the data.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Exploring The Data | Notes on Kaggle</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/Kaggle-Competitions/posts/exploring-the-data/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="Cloistered Monkey">
<link rel="prev" href="../set-up-the-kaggle-command-line-command/" title="Set Up the Kaggle Command-Line Command" type="text/html">
<link rel="next" href="../first-naive-try/" title="First Naive Try" type="text/html">
<meta property="og:site_name" content="Notes on Kaggle">
<meta property="og:title" content="Exploring The Data">
<meta property="og:url" content="https://necromuralist.github.io/Kaggle-Competitions/posts/exploring-the-data/">
<meta property="og:description" content="Looking at the data.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-08-11T15:26:40-07:00">
<meta property="article:tag" content="kaggle data exploration">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://necromuralist.github.io/Kaggle-Competitions/">

                <span id="blog-title">Notes on Kaggle</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="https://necromuralist.github.io/">The Cloistered Monkey</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="https://necromuralist.github.io/Kaggle-Competitions/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.org" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Exploring The Data</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Cloistered Monkey
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-08-11T15:26:40-07:00" itemprop="datePublished" title="2018-08-11 15:26">2018-08-11 15:26</time></a></p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org0026cd1">Imports</a></li>
<li><a href="#org962ae3c">The Tangle</a></li>
<li><a href="#orgfafdedb">Helpers</a></li>
<li><a href="#orgfc8707f">Constants</a></li>
<li><a href="#orge02dd76">The Files</a></li>
<li><a href="#orgd3d4a9b">Some Counts</a></li>
<li><a href="#orge80a645">The Official Feature Descriptions</a></li>
<li><a href="#orgcbcfe91">The Training Set</a></li>
<li><a href="#org782893a">Building Up the Training Set</a></li>
<li><a href="#org8bab984">Saving the Super Set</a></li>
<li><a href="#org74f6aae">Setting up the Training and Validation Data</a></li>
</ul>
</div>
</div>
<div id="outline-container-org0026cd1" class="outline-2">
<h2 id="org0026cd1">Imports</h2>
<div class="outline-text-2" id="text-org0026cd1">
</div>
<div id="outline-container-orgc6d411d" class="outline-3">
<h3 id="orgc6d411d">Suppressing the Numpy Warnings</h3>
<div class="outline-text-3" id="text-orgc6d411d">
<p>
When you import pandas you get some warnings:
</p>

<pre class="example">
/usr/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88
  return f(*args, **kwds)
/usr/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 96, got 88
  return f(*args, **kwds)
</pre>

<p>
According to <a href="https://stackoverflow.com/questions/40845304/runtimewarning-numpy-dtype-size-changed-may-indicate-binary-incompatibility">Stack Overflow</a>, this is because <a href="https://www.scipy.org/">scipy</a> is built against an older version of <a href="http://www.numpy.org/">numpy</a>, but it shouldn't actually affect the way it works, so we should just suppress it.
</p>

<div class="highlight"><pre><span></span>import warnings
warnings.filterwarnings("ignore", message="numpy.dtype size changed")
warnings.filterwarnings("ignore", message="numpy.ufunc size changed")
</pre></div>
</div>
</div>

<div id="outline-container-orge78eaae" class="outline-3">
<h3 id="orge78eaae">The rest of the imports</h3>
<div class="outline-text-3" id="text-orge78eaae">
<div class="highlight"><pre><span></span># python standard library
import os

# from pypi
import matplotlib.pyplot as pyplot
import numpy
import pandas
import seaborn

from sklearn.model_selection import train_test_split
</pre></div>

<div class="highlight"><pre><span></span>import pickle
from tabulate import tabulate
</pre></div>

<div class="highlight"><pre><span></span>% matplotlib inline
</pre></div>
</div>
</div>
</div>

<div id="outline-container-org962ae3c" class="outline-2">
<h2 id="org962ae3c">The Tangle</h2>
<div class="outline-text-2" id="text-org962ae3c">
<p>
Exports so some of this can be re-used.
</p>
</div>
</div>

<div id="outline-container-orgfafdedb" class="outline-2">
<h2 id="orgfafdedb">Helpers</h2>
<div class="outline-text-2" id="text-orgfafdedb">
<p>
Just some functions that keep coming up.
</p>

<div class="highlight"><pre><span></span>class Helpers:
    """Helper functions"""
    pickle_target = "../pickles/"
    pickle_target_string = pickle_target + "{}.pkl"

    @staticmethod
    def print_head(frame, showindex=False):
	"""prints the head of the given data frame

	Args:
	 frame (pandas.DataFrame): data frame to print as a table
	 showindex (bool): whether to print the index
	"""
	print(tabulate(frame.head(), headers="keys", tablefmt="orgtbl",
		       showindex=showindex))
	return

    @staticmethod
    def print_table(data, showindex=True):
	"""print the data

	Args:
	 data: some kind of data-frame
	"""
	print(tabulate(data, headers="keys", tablefmt="orgtbl",
		       showindex=showindex))
	return

    @staticmethod
    def pickle_it(thing, name=None):
	"""save the object to a pickle in the data folder

	Args:
	 thing: object to pickle
	 name: thing to call the pickle
	"""
	name = name if name is not None else thing.__name__
	with open(
		os.path.join(
		    Helpers.pickle_target_string.format(name)),
		"wb") as pickler:
	    pickle.dump(thing, pickler)
	return

    @staticmethod
    def unpickle(name):
	"""loads the pickled object from the data folder

	Args;
	 name: name of the pickle without the folder or extension

	Returns:
	 object: the un-pickled object
	"""
	with open(Helpers.pickle_target_string.format(name),
		  "rb") as unpickler:
	    unpickled = pickle.load(unpickler)
	return unpickled
</pre></div>
</div>
</div>

<div id="outline-container-orgfc8707f" class="outline-2">
<h2 id="orgfc8707f">Constants</h2>
<div class="outline-text-2" id="text-orgfc8707f">
<p>
As always, I'll try to put constants in the same place.
</p>
</div>

<div id="outline-container-orge488b96" class="outline-3">
<h3 id="orge488b96">Data Source</h3>
<div class="outline-text-3" id="text-orge488b96">
<div class="highlight"><pre><span></span>class DataSource:
    """Strings for the files"""
    directory = "../data/"
</pre></div>

<div class="highlight"><pre><span></span>DataSource.file_names = sorted(os.listdir(DataSource.directory))
for name in DataSource.file_names:
    setattr(DataSource, name.split('.')[0], name)    
DataSource.paths = [os.path.join(DataSource.directory, name)
		    for name in DataSource.file_names]
</pre></div>

<div class="highlight"><pre><span></span>Helpers.pickle_it(DataSource)
</pre></div>
</div>
</div>

<div id="outline-container-org5354fc1" class="outline-3">
<h3 id="org5354fc1">Data Keys</h3>
<div class="outline-text-3" id="text-org5354fc1">
<div class="highlight"><pre><span></span>class DataKeys:
    """Column names/keys for the data."""
    item_category = "item_category_id"
    shop = "shop_id"
    item = "item_id"
    date = "date"
    date_block = "date_block_num"
    price = "item_price"
    day_count = "item_cnt_day"
    month_count = 'item_count_month'
    name = "item_name"
</pre></div>

<div class="highlight"><pre><span></span>Helpers.pickle_it(DataKeys)
</pre></div>
</div>
</div>

<div id="outline-container-org8bc5afd" class="outline-3">
<h3 id="org8bc5afd">Pickles</h3>
<div class="outline-text-3" id="text-org8bc5afd">
<div class="highlight"><pre><span></span>class Pickles:
    """Holder of the pickle names"""
    super_set = "training_data"
    grouped = "grouped_months_data"
    x_train = "x_train"
    x_test = "x_test"
    y_train = "y_train"
    y_test = "y_test"
    train_test = "train_test"
</pre></div>

<div class="highlight"><pre><span></span>Helpers.pickle_it(Pickles)
</pre></div>
</div>
</div>
</div>

<div id="outline-container-orge02dd76" class="outline-2">
<h2 id="orge02dd76">The Files</h2>
<div class="outline-text-2" id="text-orge02dd76">
<p>
These are the files we are given.
</p>

<div class="highlight"><pre><span></span>for name in DataSource.file_names:
    print(" - {}".format(name))
</pre></div>

<ul class="org-ul">
<li>item_categories.csv</li>
<li>items.csv</li>
<li>sales_train.csv.gz</li>
<li>sample_submission.csv.gz</li>
<li>shops.csv</li>
<li>test.csv.gz</li>
</ul>
<p>
I was originally thinking I would need to unzip the gzipped files but apparently the <a href="https://pandas.pydata.org/pandas-docs/stable/io.html#io-read-csv-table"><code>Pandas.read_csv</code></a> function will decompress them automagically, so I guess I can leave them.
</p>

<div class="highlight"><pre><span></span>frames = {DataSource.file_names[index]: pandas.read_csv(path)
	  for index, path in enumerate(DataSource.paths)}
</pre></div>

<div class="highlight"><pre><span></span>for name, frame in frames.items():
    print("\n** {}".format(name))
    Helpers.print_head(frame)
    print()
    print(frame.info())
</pre></div>
</div>

<div id="outline-container-orgea3cc70" class="outline-3">
<h3 id="orgea3cc70">item_categories.csv</h3>
<div class="outline-text-3" id="text-orgea3cc70">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">item_category_name</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">PC - Гарнитуры/Наушники</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS2</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS3</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS4</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PSP</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 84 entries, 0 to 83
Data columns (total 2 columns):
item_category_name    84 non-null object
item_category_id      84 non-null int64
dtypes: int64(1), object(1)
memory usage: 1.4+ KB
None
</p>
</div>
</div>

<div id="outline-container-org3764976" class="outline-3">
<h3 id="org3764976">items.csv</h3>
<div class="outline-text-3" id="text-org3764976">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">! ВО ВЛАСТИ НАВАЖДЕНИЯ (ПЛАСТ.)         D</td>
<td class="org-right">0</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">!ABBYY FineReader 12 Professional Edition Full [PC, Цифровая версия]</td>
<td class="org-right">1</td>
<td class="org-right">76</td>
</tr>
<tr>
<td class="org-left">***В ЛУЧАХ СЛАВЫ   (UNV)                    D</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">***ГОЛУБАЯ ВОЛНА  (Univ)                      D</td>
<td class="org-right">3</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">***КОРОБКА (СТЕКЛО)                       D</td>
<td class="org-right">4</td>
<td class="org-right">40</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 22170 entries, 0 to 22169
Data columns (total 3 columns):
item_name           22170 non-null object
item_id             22170 non-null int64
item_category_id    22170 non-null int64
dtypes: int64(2), object(1)
memory usage: 519.7+ KB
None
</p>
</div>
</div>

<div id="outline-container-org88c8fb6" class="outline-3">
<h3 id="org88c8fb6">sales_train.csv.gz</h3>
<div class="outline-text-3" id="text-org88c8fb6">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date</th>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_cnt_day</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">02.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">59</td>
<td class="org-right">22154</td>
<td class="org-right">999</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">03.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">05.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">-1</td>
</tr>
<tr>
<td class="org-right">06.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2554</td>
<td class="org-right">1709.05</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">15.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2555</td>
<td class="org-right">1099</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2935849 entries, 0 to 2935848
Data columns (total 6 columns):
date              object
date_block_num    int64
shop_id           int64
item_id           int64
item_price        float64
item_cnt_day      float64
dtypes: float64(2), int64(3), object(1)
memory usage: 134.4+ MB
None
</p>
</div>
</div>

<div id="outline-container-orgbc87e44" class="outline-3">
<h3 id="orgbc87e44">sample_submission.csv.gz</h3>
<div class="outline-text-3" id="text-orgbc87e44">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">item_cnt_month</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">0.5</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214200 entries, 0 to 214199
Data columns (total 2 columns):
ID                214200 non-null int64
item_cnt_month    214200 non-null float64
dtypes: float64(1), int64(1)
memory usage: 3.3 MB
None
</p>
</div>
</div>

<div id="outline-container-org592fc88" class="outline-3">
<h3 id="org592fc88">shops.csv</h3>
<div class="outline-text-3" id="text-org592fc88">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">shop_name</th>
<th scope="col" class="org-right">shop_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">!Якутск Орджоникидзе, 56 фран</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">!Якутск ТЦ "Центральный" фран</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Адыгея ТЦ "Мега"</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Балашиха ТРК "Октябрь-Киномир"</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">Волжский ТЦ "Волга Молл"</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 60 entries, 0 to 59
Data columns (total 2 columns):
shop_name    60 non-null object
shop_id      60 non-null int64
dtypes: int64(1), object(1)
memory usage: 1.0+ KB
None
</p>
</div>
</div>

<div id="outline-container-org103dd84" class="outline-3">
<h3 id="org103dd84">test.csv.gz</h3>
<div class="outline-text-3" id="text-org103dd84">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">5037</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">5</td>
<td class="org-right">5320</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">5233</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">5</td>
<td class="org-right">5232</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">5268</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214200 entries, 0 to 214199
Data columns (total 3 columns):
ID         214200 non-null int64
shop_id    214200 non-null int64
item_id    214200 non-null int64
dtypes: int64(3)
memory usage: 4.9 MB
None
</p>
</div>
</div>

<div id="outline-container-orgee74fba" class="outline-3">
<h3 id="orgee74fba">sample_submission.csv.gz</h3>
<div class="outline-text-3" id="text-orgee74fba">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">item_cnt_month</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">0.5</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214200 entries, 0 to 214199
Data columns (total 2 columns):
ID                214200 non-null int64
item_cnt_month    214200 non-null float64
dtypes: float64(1), int64(1)
memory usage: 3.3 MB
None
</p>
</div>
</div>

<div id="outline-container-org4b87b32" class="outline-3">
<h3 id="org4b87b32">shops.csv</h3>
<div class="outline-text-3" id="text-org4b87b32">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">shop_name</th>
<th scope="col" class="org-right">shop_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">!Якутск Орджоникидзе, 56 фран</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">!Якутск ТЦ "Центральный" фран</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Адыгея ТЦ "Мега"</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Балашиха ТРК "Октябрь-Киномир"</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">Волжский ТЦ "Волга Молл"</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 60 entries, 0 to 59
Data columns (total 2 columns):
shop_name    60 non-null object
shop_id      60 non-null int64
dtypes: int64(1), object(1)
memory usage: 1.0+ KB
None
</p>
</div>
</div>

<div id="outline-container-org6b54902" class="outline-3">
<h3 id="org6b54902">items.csv</h3>
<div class="outline-text-3" id="text-org6b54902">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">! ВО ВЛАСТИ НАВАЖДЕНИЯ (ПЛАСТ.)         D</td>
<td class="org-right">0</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">!ABBYY FineReader 12 Professional Edition Full [PC, Цифровая версия]</td>
<td class="org-right">1</td>
<td class="org-right">76</td>
</tr>
<tr>
<td class="org-left">***В ЛУЧАХ СЛАВЫ   (UNV)                    D</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">***ГОЛУБАЯ ВОЛНА  (Univ)                      D</td>
<td class="org-right">3</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">***КОРОБКА (СТЕКЛО)                       D</td>
<td class="org-right">4</td>
<td class="org-right">40</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 22170 entries, 0 to 22169
Data columns (total 3 columns):
item_name           22170 non-null object
item_id             22170 non-null int64
item_category_id    22170 non-null int64
dtypes: int64(2), object(1)
memory usage: 519.7+ KB
None
</p>
</div>
</div>

<div id="outline-container-org74d6185" class="outline-3">
<h3 id="org74d6185">sales_train.csv.gz</h3>
<div class="outline-text-3" id="text-org74d6185">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date</th>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_cnt_day</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">02.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">59</td>
<td class="org-right">22154</td>
<td class="org-right">999</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">03.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">05.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">-1</td>
</tr>
<tr>
<td class="org-right">06.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2554</td>
<td class="org-right">1709.05</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">15.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2555</td>
<td class="org-right">1099</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2935849 entries, 0 to 2935848
Data columns (total 6 columns):
date              object
date_block_num    int64
shop_id           int64
item_id           int64
item_price        float64
item_cnt_day      float64
dtypes: float64(2), int64(3), object(1)
memory usage: 134.4+ MB
None
</p>
</div>
</div>

<div id="outline-container-org2551a70" class="outline-3">
<h3 id="org2551a70">item_categories.csv</h3>
<div class="outline-text-3" id="text-org2551a70">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">item_category_name</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">PC - Гарнитуры/Наушники</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS2</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS3</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS4</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PSP</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 84 entries, 0 to 83
Data columns (total 2 columns):
item_category_name    84 non-null object
item_category_id      84 non-null int64
dtypes: int64(1), object(1)
memory usage: 1.4+ KB
None
</p>
</div>
</div>

<div id="outline-container-org79079c9" class="outline-3">
<h3 id="org79079c9">test.csv.gz</h3>
<div class="outline-text-3" id="text-org79079c9">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">5037</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">5</td>
<td class="org-right">5320</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">5233</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">5</td>
<td class="org-right">5232</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">5268</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214200 entries, 0 to 214199
Data columns (total 3 columns):
ID         214200 non-null int64
shop_id    214200 non-null int64
item_id    214200 non-null int64
dtypes: int64(3)
memory usage: 4.9 MB
None
</p>
</div>
</div>

<div id="outline-container-orgbc69fd7" class="outline-3">
<h3 id="orgbc69fd7">sample_submission.csv.gz</h3>
<div class="outline-text-3" id="text-orgbc69fd7">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">item_cnt_month</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">0.5</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214200 entries, 0 to 214199
Data columns (total 2 columns):
ID                214200 non-null int64
item_cnt_month    214200 non-null float64
dtypes: float64(1), int64(1)
memory usage: 3.3 MB
None
</p>
</div>
</div>

<div id="outline-container-orgd37579f" class="outline-3">
<h3 id="orgd37579f">shops.csv</h3>
<div class="outline-text-3" id="text-orgd37579f">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">shop_name</th>
<th scope="col" class="org-right">shop_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">!Якутск Орджоникидзе, 56 фран</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">!Якутск ТЦ "Центральный" фран</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Адыгея ТЦ "Мега"</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Балашиха ТРК "Октябрь-Киномир"</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">Волжский ТЦ "Волга Молл"</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 60 entries, 0 to 59
Data columns (total 2 columns):
shop_name    60 non-null object
shop_id      60 non-null int64
dtypes: int64(1), object(1)
memory usage: 1.0+ KB
None
</p>
</div>
</div>

<div id="outline-container-org79d7a49" class="outline-3">
<h3 id="org79d7a49">items.csv</h3>
<div class="outline-text-3" id="text-org79d7a49">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">! ВО ВЛАСТИ НАВАЖДЕНИЯ (ПЛАСТ.)         D</td>
<td class="org-right">0</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">!ABBYY FineReader 12 Professional Edition Full [PC, Цифровая версия]</td>
<td class="org-right">1</td>
<td class="org-right">76</td>
</tr>
<tr>
<td class="org-left">***В ЛУЧАХ СЛАВЫ   (UNV)                    D</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">***ГОЛУБАЯ ВОЛНА  (Univ)                      D</td>
<td class="org-right">3</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">***КОРОБКА (СТЕКЛО)                       D</td>
<td class="org-right">4</td>
<td class="org-right">40</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 22170 entries, 0 to 22169
Data columns (total 3 columns):
item_name           22170 non-null object
item_id             22170 non-null int64
item_category_id    22170 non-null int64
dtypes: int64(2), object(1)
memory usage: 519.7+ KB
None
</p>
</div>
</div>

<div id="outline-container-orgc366c25" class="outline-3">
<h3 id="orgc366c25">sales_train.csv.gz</h3>
<div class="outline-text-3" id="text-orgc366c25">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date</th>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_cnt_day</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">02.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">59</td>
<td class="org-right">22154</td>
<td class="org-right">999</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">03.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">05.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">-1</td>
</tr>
<tr>
<td class="org-right">06.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2554</td>
<td class="org-right">1709.05</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">15.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2555</td>
<td class="org-right">1099</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2935849 entries, 0 to 2935848
Data columns (total 6 columns):
date              object
date_block_num    int64
shop_id           int64
item_id           int64
item_price        float64
item_cnt_day      float64
dtypes: float64(2), int64(3), object(1)
memory usage: 134.4+ MB
None
</p>
</div>
</div>

<div id="outline-container-orgfb2bec4" class="outline-3">
<h3 id="orgfb2bec4">item_categories.csv</h3>
<div class="outline-text-3" id="text-orgfb2bec4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">item_category_name</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">PC - Гарнитуры/Наушники</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS2</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS3</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS4</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PSP</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 84 entries, 0 to 83
Data columns (total 2 columns):
item_category_name    84 non-null object
item_category_id      84 non-null int64
dtypes: int64(1), object(1)
memory usage: 1.4+ KB
None
</p>
</div>
</div>

<div id="outline-container-org560f445" class="outline-3">
<h3 id="org560f445">test.csv.gz</h3>
<div class="outline-text-3" id="text-org560f445">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">5037</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">5</td>
<td class="org-right">5320</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">5233</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">5</td>
<td class="org-right">5232</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">5268</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214200 entries, 0 to 214199
Data columns (total 3 columns):
ID         214200 non-null int64
shop_id    214200 non-null int64
item_id    214200 non-null int64
dtypes: int64(3)
memory usage: 4.9 MB
None
</p>
</div>
</div>

<div id="outline-container-org64e0b69" class="outline-3">
<h3 id="org64e0b69">sample_submission.csv.gz</h3>
<div class="outline-text-3" id="text-org64e0b69">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">item_cnt_month</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">0.5</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">0.5</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214200 entries, 0 to 214199
Data columns (total 2 columns):
ID                214200 non-null int64
item_cnt_month    214200 non-null float64
dtypes: float64(1), int64(1)
memory usage: 3.3 MB
None
</p>
</div>
</div>

<div id="outline-container-orgedb42fe" class="outline-3">
<h3 id="orgedb42fe">shops.csv</h3>
<div class="outline-text-3" id="text-orgedb42fe">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">shop_name</th>
<th scope="col" class="org-right">shop_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">!Якутск Орджоникидзе, 56 фран</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">!Якутск ТЦ "Центральный" фран</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Адыгея ТЦ "Мега"</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Балашиха ТРК "Октябрь-Киномир"</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">Волжский ТЦ "Волга Молл"</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 60 entries, 0 to 59
Data columns (total 2 columns):
shop_name    60 non-null object
shop_id      60 non-null int64
dtypes: int64(1), object(1)
memory usage: 1.0+ KB
None
</p>
</div>
</div>

<div id="outline-container-org3677f64" class="outline-3">
<h3 id="org3677f64">items.csv</h3>
<div class="outline-text-3" id="text-org3677f64">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">! ВО ВЛАСТИ НАВАЖДЕНИЯ (ПЛАСТ.)         D</td>
<td class="org-right">0</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">!ABBYY FineReader 12 Professional Edition Full [PC, Цифровая версия]</td>
<td class="org-right">1</td>
<td class="org-right">76</td>
</tr>
<tr>
<td class="org-left">***В ЛУЧАХ СЛАВЫ   (UNV)                    D</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">***ГОЛУБАЯ ВОЛНА  (Univ)                      D</td>
<td class="org-right">3</td>
<td class="org-right">40</td>
</tr>
<tr>
<td class="org-left">***КОРОБКА (СТЕКЛО)                       D</td>
<td class="org-right">4</td>
<td class="org-right">40</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 22170 entries, 0 to 22169
Data columns (total 3 columns):
item_name           22170 non-null object
item_id             22170 non-null int64
item_category_id    22170 non-null int64
dtypes: int64(2), object(1)
memory usage: 519.7+ KB
None
</p>
</div>
</div>

<div id="outline-container-orgdf5c884" class="outline-3">
<h3 id="orgdf5c884">sales_train.csv.gz</h3>
<div class="outline-text-3" id="text-orgdf5c884">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date</th>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_cnt_day</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">02.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">59</td>
<td class="org-right">22154</td>
<td class="org-right">999</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">03.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">05.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">-1</td>
</tr>
<tr>
<td class="org-right">06.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2554</td>
<td class="org-right">1709.05</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">15.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2555</td>
<td class="org-right">1099</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2935849 entries, 0 to 2935848
Data columns (total 6 columns):
date              object
date_block_num    int64
shop_id           int64
item_id           int64
item_price        float64
item_cnt_day      float64
dtypes: float64(2), int64(3), object(1)
memory usage: 134.4+ MB
None
</p>
</div>
</div>

<div id="outline-container-org0c180dc" class="outline-3">
<h3 id="org0c180dc">item_categories.csv</h3>
<div class="outline-text-3" id="text-org0c180dc">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">item_category_name</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">PC - Гарнитуры/Наушники</td>
<td class="org-right">0</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS2</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS3</td>
<td class="org-right">2</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PS4</td>
<td class="org-right">3</td>
</tr>
<tr>
<td class="org-left">Аксессуары - PSP</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 84 entries, 0 to 83
Data columns (total 2 columns):
item_category_name    84 non-null object
item_category_id      84 non-null int64
dtypes: int64(1), object(1)
memory usage: 1.4+ KB
None
</p>
</div>
</div>

<div id="outline-container-org219e920" class="outline-3">
<h3 id="org219e920">test.csv.gz</h3>
<div class="outline-text-3" id="text-org219e920">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">ID</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">5037</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">5</td>
<td class="org-right">5320</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">5233</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">5</td>
<td class="org-right">5232</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">5268</td>
</tr>
</tbody>
</table>
<p>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214200 entries, 0 to 214199
Data columns (total 3 columns):
ID         214200 non-null int64
shop_id    214200 non-null int64
item_id    214200 non-null int64
dtypes: int64(3)
memory usage: 4.9 MB
None
</p>
</div>
</div>
</div>

<div id="outline-container-orgd3d4a9b" class="outline-2">
<h2 id="orgd3d4a9b">Some Counts</h2>
<div class="outline-text-2" id="text-orgd3d4a9b">
</div>
<div id="outline-container-orga4a35eb" class="outline-3">
<h3 id="orga4a35eb">How much data is there in the training set?</h3>
<div class="outline-text-3" id="text-orga4a35eb">
<div class="highlight"><pre><span></span>print("There are {:,} rows in the training set.".format(len(frames[DataSource.sales_train])))
</pre></div>

<p>
There are 2,935,849 rows in the training set.
</p>
</div>
</div>

<div id="outline-container-org9e775ca" class="outline-3">
<h3 id="org9e775ca">How many shops are there?</h3>
<div class="outline-text-3" id="text-org9e775ca">
<div class="highlight"><pre><span></span>print("There are {} shops.".format(len(frames[DataSource.shops])))
</pre></div>

<p>
There are 60 shops.
</p>
</div>
</div>

<div id="outline-container-orgc87bf35" class="outline-3">
<h3 id="orgc87bf35">How Many Items Are There?</h3>
<div class="outline-text-3" id="text-orgc87bf35">
<div class="highlight"><pre><span></span>print("There are {:,} items.".format(len(frames[DataSource.items])))
</pre></div>

<p>
There are 22,170 items.
</p>
</div>
</div>

<div id="outline-container-org825ff6b" class="outline-3">
<h3 id="org825ff6b">How Many Item Categories are there?</h3>
<div class="outline-text-3" id="text-org825ff6b">
<div class="highlight"><pre><span></span>print("There are {:,} categories.".format(len(frames[DataSource.item_categories])))
</pre></div>

<p>
There are 84 categories.
</p>
</div>
</div>

<div id="outline-container-orga140949" class="outline-3">
<h3 id="orga140949">How many date-blocks are there?</h3>
<div class="outline-text-3" id="text-orga140949">
<div class="highlight"><pre><span></span>print("There are {} date-blocks.".format(
    len(frames[DataSource.sales_train][DataKeys.date_block].unique())))
</pre></div>

<p>
There are 34 date-blocks.
There are 34 date-blocks.
</p>
</div>
</div>
</div>

<div id="outline-container-orge80a645" class="outline-2">
<h2 id="orge80a645">The Official Feature Descriptions</h2>
<div class="outline-text-2" id="text-orge80a645">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-left">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">Column Name</th>
<th scope="col" class="org-left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">ID</td>
<td class="org-left">an Id that represents a (Shop, Item) tuple within the test set</td>
</tr>
<tr>
<td class="org-left">shop_id</td>
<td class="org-left">unique identifier of a shop</td>
</tr>
<tr>
<td class="org-left">item_id</td>
<td class="org-left">unique identifier of a product</td>
</tr>
<tr>
<td class="org-left">item_category_id</td>
<td class="org-left">unique identifier of item category</td>
</tr>
<tr>
<td class="org-left">item_cnt_day</td>
<td class="org-left">number of products sold. You are predicting a monthly amount of this measure</td>
</tr>
<tr>
<td class="org-left">item_price</td>
<td class="org-left">current price of an item</td>
</tr>
<tr>
<td class="org-left">date</td>
<td class="org-left">date in format dd/mm/yyyy</td>
</tr>
<tr>
<td class="org-left">date_block_num</td>
<td class="org-left">a consecutive month number, used for convenience. January 2013 is 0, February 2013 is 1,…, October 2015 is 33</td>
</tr>
<tr>
<td class="org-left">item_name</td>
<td class="org-left">name of item</td>
</tr>
<tr>
<td class="org-left">shop_name</td>
<td class="org-left">name of shop</td>
</tr>
<tr>
<td class="org-left">item_category_name</td>
<td class="org-left">name of item category</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgcbcfe91" class="outline-2">
<h2 id="orgcbcfe91">The Training Set</h2>
<div class="outline-text-2" id="text-orgcbcfe91">
<div class="highlight"><pre><span></span>print(frames[DataSource.sales_train].dtypes)
</pre></div>

<p>
date               object
date_block_num      int64
shop_id             int64
item_id             int64
item_price        float64
item_cnt_day      float64
dtype: object
date               object
date_block_num      int64
shop_id             int64
item_id             int64
item_price        float64
item_cnt_day      float64
dtype: object
</p>
</div>

<div id="outline-container-orge3f9030" class="outline-3">
<h3 id="orge3f9030">Numeric Features</h3>
<div class="outline-text-3" id="text-orge3f9030">
<div class="highlight"><pre><span></span>Helpers.print_table(frames[DataSource.sales_train].describe(include=numpy.number).T)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left"> </th>
<th scope="col" class="org-right">count</th>
<th scope="col" class="org-right">mean</th>
<th scope="col" class="org-right">std</th>
<th scope="col" class="org-right">min</th>
<th scope="col" class="org-right">25%</th>
<th scope="col" class="org-right">50%</th>
<th scope="col" class="org-right">75%</th>
<th scope="col" class="org-right">max</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">date_block_num</td>
<td class="org-right">2.93585e+06</td>
<td class="org-right">14.5699</td>
<td class="org-right">9.42299</td>
<td class="org-right">0</td>
<td class="org-right">7</td>
<td class="org-right">14</td>
<td class="org-right">23</td>
<td class="org-right">33</td>
</tr>
<tr>
<td class="org-left">shop_id</td>
<td class="org-right">2.93585e+06</td>
<td class="org-right">33.0017</td>
<td class="org-right">16.227</td>
<td class="org-right">0</td>
<td class="org-right">22</td>
<td class="org-right">31</td>
<td class="org-right">47</td>
<td class="org-right">59</td>
</tr>
<tr>
<td class="org-left">item_id</td>
<td class="org-right">2.93585e+06</td>
<td class="org-right">10197.2</td>
<td class="org-right">6324.3</td>
<td class="org-right">0</td>
<td class="org-right">4476</td>
<td class="org-right">9343</td>
<td class="org-right">15684</td>
<td class="org-right">22169</td>
</tr>
<tr>
<td class="org-left">item_price</td>
<td class="org-right">2.93585e+06</td>
<td class="org-right">890.853</td>
<td class="org-right">1729.8</td>
<td class="org-right">-1</td>
<td class="org-right">249</td>
<td class="org-right">399</td>
<td class="org-right">999</td>
<td class="org-right">307980</td>
</tr>
<tr>
<td class="org-left">item_cnt_day</td>
<td class="org-right">2.93585e+06</td>
<td class="org-right">1.24264</td>
<td class="org-right">2.61883</td>
<td class="org-right">-22</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">2169</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orga1aca4e" class="outline-3">
<h3 id="orga1aca4e">Categorical Features</h3>
<div class="outline-text-3" id="text-orga1aca4e">
<div class="highlight"><pre><span></span>Helpers.print_table(frames[DataSource.sales_train].describe(include=[numpy.object, pandas.Categorical]).T)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-left"> </th>
<th scope="col" class="org-right">count</th>
<th scope="col" class="org-right">unique</th>
<th scope="col" class="org-right">top</th>
<th scope="col" class="org-right">freq</th>
</tr></thead>
<tbody><tr>
<td class="org-left">date</td>
<td class="org-right">2.93585e+06</td>
<td class="org-right">1034</td>
<td class="org-right">28.12.2013</td>
<td class="org-right">9434</td>
</tr></tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org782893a" class="outline-2">
<h2 id="org782893a">Building Up the Training Set</h2>
<div class="outline-text-2" id="text-org782893a">
<p>
Since we have some variables in separate sets I thought it would be useful to combine them into a single training set.
</p>
</div>

<div id="outline-container-org788e8e6" class="outline-3">
<h3 id="org788e8e6">Building the Super Set</h3>
<div class="outline-text-3" id="text-org788e8e6">
<div class="highlight"><pre><span></span>super_set = frames[DataSource.sales_train].copy()
</pre></div>

<div class="highlight"><pre><span></span>Helpers.print_head(super_set)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date</th>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_cnt_day</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">02.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">59</td>
<td class="org-right">22154</td>
<td class="org-right">999</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">03.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">05.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">-1</td>
</tr>
<tr>
<td class="org-right">06.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2554</td>
<td class="org-right">1709.05</td>
<td class="org-right">1</td>
</tr>
<tr>
<td class="org-right">15.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2555</td>
<td class="org-right">1099</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf08604d" class="outline-3">
<h3 id="orgf08604d">Adding The Category ID</h3>
<div class="outline-text-3" id="text-orgf08604d">
<div class="highlight"><pre><span></span>super_set = pandas.merge(super_set, frames[DataSource.items], on=DataKeys.item, how="left")
</pre></div>

<div class="highlight"><pre><span></span>Helpers.print_head(super_set)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date</th>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_cnt_day</th>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_category_id</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">02.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">59</td>
<td class="org-right">22154</td>
<td class="org-right">999</td>
<td class="org-right">1</td>
<td class="org-left">ЯВЛЕНИЕ 2012 (BD)</td>
<td class="org-right">37</td>
</tr>
<tr>
<td class="org-right">03.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">1</td>
<td class="org-left">DEEP PURPLE  The House Of Blue Light  LP</td>
<td class="org-right">58</td>
</tr>
<tr>
<td class="org-right">05.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">-1</td>
<td class="org-left">DEEP PURPLE  The House Of Blue Light  LP</td>
<td class="org-right">58</td>
</tr>
<tr>
<td class="org-right">06.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2554</td>
<td class="org-right">1709.05</td>
<td class="org-right">1</td>
<td class="org-left">DEEP PURPLE  Who Do You Think We Are  LP</td>
<td class="org-right">58</td>
</tr>
<tr>
<td class="org-right">15.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2555</td>
<td class="org-right">1099</td>
<td class="org-right">1</td>
<td class="org-left">DEEP PURPLE 30 Very Best Of 2CD (Фирм.)</td>
<td class="org-right">56</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span>counts = super_set[DataKeys.item_category].value_counts(sort=True)
</pre></div>

<div class="highlight"><pre><span></span>figure = pyplot.figure(figsize=(10, 8))
axe = figure.gca()
axe.set_title("Category Counts")
axe.set_ylabel("Category")
axe.set_xlabel("Count")
# plot = axe.plot(counts.index, counts.item_id, 'o')
plot = counts.plot.barh(ax=axe)
</pre></div>


<div class="figure">
<p><img src="../files/posts/exploring-the-data/categories.png" alt="categories.png"></p>
</div>

<p>
<img src="../files/posts/exploring-the-data/categories.png" alt="categories.png"><img src="categories.png" alt="categories.png"></p>

<p>
It looks like a few categories dominate the sales.
</p>
</div>
</div>

<div id="outline-container-orgb5605c1" class="outline-3">
<h3 id="orgb5605c1">What do the dates mean?</h3>
<div class="outline-text-3" id="text-orgb5605c1">
<p>
If you look at the head of the training data it looks like only one item was sold or returned per day. This seems like it wouldn't be the case, so lets see how many shops and items there are per day.
</p>

<div class="highlight"><pre><span></span>days = super_set.groupby(DataKeys.date)
day_counts = days.count()
</pre></div>

<p>
<code>day_counts</code> is just the number of entries there are for each day, regardless of how many of each item were sold per day.
</p>

<div class="highlight"><pre><span></span>figure =  pyplot.figure(figsize=(12, 10))
axe = figure.gca()
axe.set_title("Entries Per Day")
axe.set_ylabel("Entries")
axe.set_xlabel("Date")
axe = axe.plot(day_counts.item_id, '.')
</pre></div>

<p>
<img src="../files/posts/exploring-the-data/items_per_date.png" alt="items_per_date.png"><img src="items_per_date.png" alt="items_per_date.png"></p>

<p>
It looks like there was actually a lot of entries per date.
</p>
</div>
</div>

<div id="outline-container-org7707bfd" class="outline-3">
<h3 id="org7707bfd">Splitting the Dates</h3>
<div class="outline-text-3" id="text-org7707bfd">
<div class="highlight"><pre><span></span>class Dates:
    date_expression = r'(?P&lt;day&gt;\d{2})\.(?P&lt;month&gt;\d{2})\.(?P&lt;year&gt;\d{4})'
</pre></div>

<div class="highlight"><pre><span></span>dates = super_set.date.str.extract(Dates.date_expression)
</pre></div>

<div class="highlight"><pre><span></span>print(tabulate(dates.head(), headers="keys", showindex='never', tablefmt='orgtbl'))
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">day</th>
<th scope="col" class="org-right">month</th>
<th scope="col" class="org-right">year</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">02</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">03</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">05</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">06</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">15</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
</tbody>
</table>
<p>
Now we can smash our new data frame onto the transactions using the <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html">concat</a> function. by default it will try to add the rows from the second data frame to the rows of the first, but since we're adding new columns we need to pass in the <code>axis='columns'</code> argument.
</p>

<div class="highlight"><pre><span></span>super_set = pandas.concat((super_set, dates), axis='columns')
</pre></div>

<div class="highlight"><pre><span></span>Helpers.print_head(super_set)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date</th>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_cnt_day</th>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_category_id</th>
<th scope="col" class="org-right">day</th>
<th scope="col" class="org-right">month</th>
<th scope="col" class="org-right">year</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">02.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">59</td>
<td class="org-right">22154</td>
<td class="org-right">999</td>
<td class="org-right">1</td>
<td class="org-left">ЯВЛЕНИЕ 2012 (BD)</td>
<td class="org-right">37</td>
<td class="org-right">02</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">03.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">1</td>
<td class="org-left">DEEP PURPLE  The House Of Blue Light  LP</td>
<td class="org-right">58</td>
<td class="org-right">03</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">05.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2552</td>
<td class="org-right">899</td>
<td class="org-right">-1</td>
<td class="org-left">DEEP PURPLE  The House Of Blue Light  LP</td>
<td class="org-right">58</td>
<td class="org-right">05</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">06.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2554</td>
<td class="org-right">1709.05</td>
<td class="org-right">1</td>
<td class="org-left">DEEP PURPLE  Who Do You Think We Are  LP</td>
<td class="org-right">58</td>
<td class="org-right">06</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">15.01.2013</td>
<td class="org-right">0</td>
<td class="org-right">25</td>
<td class="org-right">2555</td>
<td class="org-right">1099</td>
<td class="org-right">1</td>
<td class="org-left">DEEP PURPLE 30 Very Best Of 2CD (Фирм.)</td>
<td class="org-right">56</td>
<td class="org-right">15</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org8bab984" class="outline-2">
<h2 id="org8bab984">Saving the Super Set</h2>
<div class="outline-text-2" id="text-org8bab984">
<div class="highlight"><pre><span></span>Helpers.pickle_it(super_set, Pickles.super_set)
</pre></div>
</div>
</div>

<div id="outline-container-org74f6aae" class="outline-2">
<h2 id="org74f6aae">Setting up the Training and Validation Data</h2>
<div class="outline-text-2" id="text-org74f6aae">
<p>
Although I went through the trouble of smashing all the values into one Data Frame, it turns out that I need things grouped by month, and doing the grouping after adding the columns just make it messy, so I'm going to back-track a little here to set up the data we need for training and testing.
</p>
</div>

<div id="outline-container-org513b8f7" class="outline-3">
<h3 id="org513b8f7">The Grouper</h3>
<div class="outline-text-3" id="text-org513b8f7">
<p>
Since I'm going to aggregate by the month (really the <code>date_block_num</code>), leaving in things like the price doesn't really make sense so I'll make a sub-frame that I can group.
</p>
<div class="highlight"><pre><span></span>grouper = super_set[[DataKeys.date_block, DataKeys.shop, DataKeys.item, DataKeys.day_count]].copy()
grouped = grouper.groupby([DataKeys.date_block, DataKeys.shop, DataKeys.item]).sum()
</pre></div>

<div class="highlight"><pre><span></span>chunked = grouped.reset_index()
chunked.rename(columns={DataKeys.day_count: DataKeys.month_count}, inplace=True)
print(chunked.head())
</pre></div>

<p>
   date_block_num  shop_id  item_id  item_count_month
0               0        0       32               6.0
1               0        0       33               3.0
2               0        0       35               1.0
3               0        0       43               1.0
4               0        0       51               2.0
   date_block_num  shop_id  item_id  item_count_month
0               0        0       32               6.0
1               0        0       33               3.0
2               0        0       35               1.0
3               0        0       43               1.0
4               0        0       51               2.0
</p>
</div>
</div>

<div id="outline-container-org74f5536" class="outline-3">
<h3 id="org74f5536">Adding the Columns Back</h3>
<div class="outline-text-3" id="text-org74f5536">
<p>
Since there are multiple entries for items in a given month, I'm going to group the items by shop and date-block (month) and then grab the last entry for each group. I'm also going to delete the <i>date</i> column since we don't really need it.
</p>

<div class="highlight"><pre><span></span>del(super_set["date"])
</pre></div>

<div class="highlight"><pre><span></span>super_group = super_set.groupby([DataKeys.date_block, DataKeys.shop, DataKeys.item]).last()
super_group = super_group.reset_index()
</pre></div>

<div class="highlight"><pre><span></span>Helpers.print_head(super_group, True)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right"> </th>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-right">item_cnt_day</th>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_category_id</th>
<th scope="col" class="org-right">day</th>
<th scope="col" class="org-right">month</th>
<th scope="col" class="org-right">year</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">32</td>
<td class="org-right">221</td>
<td class="org-right">1</td>
<td class="org-left">1+1</td>
<td class="org-right">40</td>
<td class="org-right">31</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">33</td>
<td class="org-right">347</td>
<td class="org-right">1</td>
<td class="org-left">1+1 (BD)</td>
<td class="org-right">37</td>
<td class="org-right">28</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">35</td>
<td class="org-right">247</td>
<td class="org-right">1</td>
<td class="org-left">10 ЛЕТ СПУСТЯ</td>
<td class="org-right">40</td>
<td class="org-right">31</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">43</td>
<td class="org-right">221</td>
<td class="org-right">1</td>
<td class="org-left">100 МИЛЛИОНОВ ЕВРО</td>
<td class="org-right">40</td>
<td class="org-right">31</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">4</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">51</td>
<td class="org-right">127</td>
<td class="org-right">1</td>
<td class="org-left">100 лучших произведений классики (mp3-CD) (Digipack)</td>
<td class="org-right">57</td>
<td class="org-right">31</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
</tbody>
</table>
<p>
Now we need to get the category id, price, etc, back into the grouped data by merging it with the de-duplicated one we just created.
</p>
<div class="highlight"><pre><span></span>chunked = pandas.merge(chunked, super_group,
		       on=[DataKeys.date_block, DataKeys.shop, DataKeys.item], how="left")
</pre></div>


<div class="highlight"><pre><span></span>print(chunked.head())
</pre></div>

<p>
   date_block_num  shop_id  item_id  item_count_month  item_price  \
0               0        0       32               6.0       221.0   
1               0        0       33               3.0       347.0   
2               0        0       35               1.0       247.0   
3               0        0       43               1.0       221.0   
4               0        0       51               2.0       127.0   
</p>

<p>
   item_cnt_day                                          item_name  \
0           1.0                                                1+1   
1           1.0                                           1+1 (BD)   
2           1.0                                      10 ЛЕТ СПУСТЯ   
3           1.0                                 100 МИЛЛИОНОВ ЕВРО   
4           1.0  100 лучших произведений классики (mp3-CD) (Dig…   
</p>

<p>
   item_category_id day month  year  
0                40  31    01  2013  
1                37  28    01  2013  
2                40  31    01  2013  
3                40  31    01  2013  
4                57  31    01  2013  
   date_block_num  shop_id  item_id  item_count_month  item_price  \
0               0        0       32               6.0       221.0   
1               0        0       33               3.0       347.0   
2               0        0       35               1.0       247.0   
3               0        0       43               1.0       221.0   
4               0        0       51               2.0       127.0   
</p>

<p>
   item_cnt_day  item_category_id day month  year  
0           1.0                40  31    01  2013  
1           1.0                37  28    01  2013  
2           1.0                40  31    01  2013  
3           1.0                40  31    01  2013  
4           1.0                57  31    01  2013  
</p>


<p>
It looks like the day-count is still there, which doesn't make sense any more so I'll remove it, along with the <code>day</code> column.
</p>

<div class="highlight"><pre><span></span>del(chunked[DataKeys.day_count])
del(chunked['day'])
</pre></div>

<div class="highlight"><pre><span></span>Helpers.print_head(chunked)
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-right">
<col class="org-left">
<col class="org-right">
<col class="org-right">
<col class="org-right">
</colgroup>
<thead><tr>
<th scope="col" class="org-right">date_block_num</th>
<th scope="col" class="org-right">shop_id</th>
<th scope="col" class="org-right">item_id</th>
<th scope="col" class="org-right">item_count_month</th>
<th scope="col" class="org-right">item_price</th>
<th scope="col" class="org-left">item_name</th>
<th scope="col" class="org-right">item_category_id</th>
<th scope="col" class="org-right">month</th>
<th scope="col" class="org-right">year</th>
</tr></thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">32</td>
<td class="org-right">6</td>
<td class="org-right">221</td>
<td class="org-left">1+1</td>
<td class="org-right">40</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">33</td>
<td class="org-right">3</td>
<td class="org-right">347</td>
<td class="org-left">1+1 (BD)</td>
<td class="org-right">37</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">35</td>
<td class="org-right">1</td>
<td class="org-right">247</td>
<td class="org-left">10 ЛЕТ СПУСТЯ</td>
<td class="org-right">40</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">43</td>
<td class="org-right">1</td>
<td class="org-right">221</td>
<td class="org-left">100 МИЛЛИОНОВ ЕВРО</td>
<td class="org-right">40</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">51</td>
<td class="org-right">2</td>
<td class="org-right">127</td>
<td class="org-left">100 лучших произведений классики (mp3-CD) (Digipack)</td>
<td class="org-right">57</td>
<td class="org-right">01</td>
<td class="org-right">2013</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span>print(len(chunked))
</pre></div>

<p>
1609124
1609124
</p>

<div class="highlight"><pre><span></span>Helpers.pickle_it(chunked, Pickles.grouped)
</pre></div>

<p>
To make my validation and training set I'm going to use sklearn's <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">train_test_split</a>. First we need to split the data up into inputs and targets
</p>
<div class="highlight"><pre><span></span>target = chunked[DataKeys.month_count].copy()
features = chunked[chunked.columns[chunked.columns != DataKeys.month_count]].copy()
</pre></div>

<div class="highlight"><pre><span></span>print(target.shape)
print(features.shape)
</pre></div>

<p>
(1609124,)
(1609124, 8)
(1609124,)
(1609124, 7)
</p>

<div class="highlight"><pre><span></span>x_train, x_test, y_train, y_test = train_test_split(features, target,
						    test_size=0.2,
						    random_state=2018)

Helpers.pickle_it(x_train, Pickles.x_train)
Helpers.pickle_it(x_test, Pickles.x_test)
Helpers.pickle_it(y_train, Pickles.y_train)
Helpers.pickle_it(y_test, Pickles.y_test)
</pre></div>

<div class="highlight"><pre><span></span>class TrainTest:
    x_train = x_train
    x_test = x_test
    y_train = y_train
    y_test = y_test
</pre></div>

<div class="highlight"><pre><span></span>Helpers.pickle_it(TrainTest, Pickles.train_test)
</pre></div>

<div class="highlight"><pre><span></span>print(x_train.shape)
print(x_test.shape)
print(y_train.shape)
print(y_test.shape)
</pre></div>

<p>
(1287299, 7)
(321825, 7)
(1287299,)
(321825,)
</p>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/kaggle-data-exploration/" rel="tag">kaggle data exploration</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../set-up-the-kaggle-command-line-command/" rel="prev" title="Set Up the Kaggle Command-Line Command">Previous post</a>
            </li>
            <li class="next">
                <a href="../first-naive-try/" rel="next" title="First Naive Try">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
